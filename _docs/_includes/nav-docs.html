<div id="afd-toc" class="collapse d-md-block mb-4">
  <nav class="afd-links">
    {% assign page_slug = page.url | split: '/' | last %}
    {% for group in site.data.nav %}
    {% assign link = group.pages | first %}
    {% assign link_slug = link.title | slugify %}
    {% assign group_slug = group.title | slugify %}
    {% assign active = nil %}

    {% if page.group == group_slug %}
      {% assign active = 'active' %}
    {% endif %}

    <div class="afd-toc-item">
      <a class="afd-toc-link {{ active }}" {% if link_slug.size > 0 %}href="#sidenav-{{ group_slug }}" data-toggle="collapse" aria-expanded="false" aria-controls="sidenav-{{ group_slug }}"{% else %}href="{{ site.baseurl }}/{{ group_slug }}/{{ link_slug }}/"{% endif %}>
        {{ group.title }}
        <span class="fa fa-chevron-down ml-auto" aria-hidden="true"></span>
      </a>

      {% if page.group == group_slug %}
        {% assign active = 'show' %}
      {% endif %}

      {% if link_slug.size > 0 %}
        <div class="ml-4 collapse afd-sidenav {{ active }}" id="sidenav-{{ group_slug }}">
          <ul class="nav d-flex flex-column">
            {% for doc in group.pages %}
              {% assign doc_slug = doc.title | slugify %}
              {% assign active = nil %}

              {% if page.group == group_slug and page_slug == doc_slug %}
                {% assign active = 'active afd-sidenav-active' %}
              {% endif %}

              <li class="nav-item">
                <a class="nav-link {{ active }}" href="{{ site.baseurl }}/{{ group_slug }}/{{ doc_slug }}/">
                  {{ doc.title }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}

    </div>

    {% endfor %}
  </nav>
</div>
